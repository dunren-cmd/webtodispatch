# 完整測試指南

## 🎯 測試流程

### 階段 1：測試後端（Google Apps Script）

#### 步驟 1.1：測試基本設定

1. 在 Google Apps Script 編輯器中
2. 選擇 `testBasicSetup` 函數
3. 點擊「執行」
4. 查看執行記錄（「檢視」→「執行記錄」）

**預期結果**：
- ✅ 成功開啟試算表
- ✅ 列出所有工作表
- ✅ 顯示工作表狀態

**如果有錯誤**：
- 檢查試算表 ID 是否正確
- 確認試算表已分享給執行腳本的帳號

#### 步驟 1.2：測試建立員工

1. 選擇 `testSaveUser` 函數
2. 點擊「執行」
3. 查看執行記錄

**預期結果**：
- ✅ 顯示「員工資料已成功儲存」
- ✅ 返回 success: true

**驗證**：
- 開啟 Google Sheets
- 檢查「人員管理_交辦」工作表是否有新資料

#### 步驟 1.3：測試取得員工列表

1. 選擇 `testGetUsers` 函數
2. 點擊「執行」
3. 查看執行記錄

**預期結果**：
- ✅ 返回員工列表（JSON 格式）
- ✅ 包含剛才建立的測試員工

#### 步驟 1.4：測試建立任務

1. 選擇 `testSaveTask` 函數
2. 點擊「執行」
3. 查看執行記錄

**預期結果**：
- ✅ 顯示「任務已成功儲存」
- ✅ 返回 success: true

**驗證**：
- 開啟 Google Sheets
- 檢查「交辦紀錄」工作表是否有新資料

#### 步驟 1.5：測試取得任務列表

1. 選擇 `testGetTasks` 函數
2. 點擊「執行」
3. 查看執行記錄

**預期結果**：
- ✅ 返回任務列表（JSON 格式）
- ✅ 包含剛才建立的測試任務

---

### 階段 2：測試 Web App API

#### 步驟 2.1：測試 GET 請求（瀏覽器）

在瀏覽器中訪問以下 URL（替換為你的 Web App URL）：

```
https://script.google.com/macros/s/YOUR_WEB_APP_ID/exec?action=getUsers
```

**預期結果**：
```json
{
  "success": true,
  "data": [...]
}
```

#### 步驟 2.2：測試預設回應

訪問 Web App URL（不帶參數）：
```
https://script.google.com/macros/s/YOUR_WEB_APP_ID/exec
```

**預期結果**：
```json
{
  "message": "任務交辦系統 API 服務運行中",
  "timestamp": "..."
}
```

---

### 階段 3：測試前端應用程式

#### 步驟 3.1：啟動前端

1. 開啟終端機
2. 進入 `WebToDispatch_2` 資料夾
3. 執行：
   ```bash
   npm run dev
   ```
4. 等待瀏覽器自動開啟（通常是 `http://localhost:3000`）

#### 步驟 3.2：測試載入資料

1. 開啟瀏覽器開發者工具（F12）
2. 切換到「Console」標籤
3. 查看是否有錯誤訊息

**預期結果**：
- ✅ 頁面正常載入
- ✅ 顯示任務列表（如果有資料）
- ✅ Console 沒有錯誤

#### 步驟 3.3：測試新增員工

1. 點擊頂部導航欄的「員工管理」按鈕
2. 點擊「新增員工」按鈕
3. 填寫表單：
   - 姓名：測試員工
   - 角色：選擇一個角色（例如：護理師）
   - 頭像：選擇一個頭像
4. 點擊「確認新增」

**預期結果**：
- ✅ 顯示「員工資料已成功新增！」
- ✅ 返回員工管理頁面
- ✅ 可以看到新建立的員工

**驗證**：
- 開啟 Google Sheets
- 檢查「人員管理_交辦」工作表是否有新資料

#### 步驟 3.4：測試建立任務

1. 點擊「交辦任務」按鈕
2. 填寫表單：
   - 選擇交辦人
   - 選擇承辦人
   - 選擇協作者（可選）
   - 選擇職類歸屬
   - 輸入任務描述
   - 輸入任務標題
   - 選擇日期
3. 點擊「確認交辦」

**預期結果**：
- ✅ 返回總表頁面
- ✅ 可以看到新建立的任務
- ✅ 任務顯示在列表中

**驗證**：
- 開啟 Google Sheets
- 檢查「交辦紀錄」工作表是否有新資料

#### 步驟 3.5：測試更新任務狀態

1. 在任務列表中，點擊一個任務卡片展開
2. 點擊「確認任務完成」按鈕

**預期結果**：
- ✅ 任務狀態更新為「已完成」
- ✅ 任務卡片顏色改變

**驗證**：
- 開啟 Google Sheets
- 檢查該任務的狀態欄位是否更新為「done」

#### 步驟 3.6：測試更新承辦人回覆

1. 點擊任務卡片展開
2. 點擊「編輯內容」按鈕
3. 輸入回覆內容
4. 點擊「儲存」

**預期結果**：
- ✅ 回覆內容已更新
- ✅ 任務狀態自動更新為「進行中」

**驗證**：
- 開啟 Google Sheets
- 檢查該任務的「承辦人回覆」欄位是否更新

#### 步驟 3.7：測試新增佐證資料

1. 點擊任務卡片展開
2. 點擊「+ 統計數據」或「+ Drive 連結」按鈕
3. 輸入資料

**預期結果**：
- ✅ 佐證資料顯示在任務卡片中
- ✅ 可以刪除佐證資料

**驗證**：
- 開啟 Google Sheets
- 檢查該任務的「佐證資料」欄位（JSON 格式）

---

## 🔍 檢查清單

### 後端測試
- [ ] `testBasicSetup` 執行成功
- [ ] `testSaveUser` 執行成功
- [ ] `testGetUsers` 執行成功
- [ ] `testSaveTask` 執行成功
- [ ] `testGetTasks` 執行成功
- [ ] Web App URL 可以訪問
- [ ] GET 請求返回正確的 JSON

### 前端測試
- [ ] 前端應用程式可以啟動
- [ ] 頁面正常載入
- [ ] 可以新增員工
- [ ] 可以建立任務
- [ ] 可以更新任務狀態
- [ ] 可以更新承辦人回覆
- [ ] 可以新增佐證資料
- [ ] Console 沒有錯誤

### 資料驗證
- [ ] Google Sheets 中有員工資料
- [ ] Google Sheets 中有任務資料
- [ ] 資料格式正確
- [ ] 更新操作可以同步到 Sheets

---

## 🐛 常見問題

### 問題 1：前端無法載入資料

**檢查**：
1. 確認 `api.ts` 中的 `API_URL` 正確
2. 確認 Web App 已部署
3. 確認部署設定中選擇「任何人」
4. 查看瀏覽器 Console 的錯誤訊息

### 問題 2：建立任務失敗

**檢查**：
1. 確認必填欄位都有填寫
2. 確認日期格式正確
3. 查看瀏覽器 Console 的錯誤訊息
4. 查看 Google Apps Script 執行記錄

### 問題 3：資料沒有儲存到 Sheets

**檢查**：
1. 確認試算表 ID 正確
2. 確認試算表已分享給執行腳本的帳號
3. 查看 Google Apps Script 執行記錄
4. 確認工作表名稱正確

---

## 📞 需要協助？

如果測試過程中遇到問題，請提供：
1. 錯誤訊息（瀏覽器 Console 或執行記錄）
2. 測試的步驟
3. 預期結果 vs 實際結果

