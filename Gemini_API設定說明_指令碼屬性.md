# Gemini API Key 設定說明（指令碼屬性）

## 📋 設定步驟

### 步驟 1：取得 Gemini API Key

1. 前往 [Google AI Studio](https://aistudio.google.com/app/apikey)
2. 登入你的 Google 帳號
3. 點擊「建立 API 金鑰」
4. 複製 API Key（格式：`AIza...`）

### 步驟 2：設定指令碼屬性

1. **開啟 Google Apps Script 專案**
   - 前往 [Google Apps Script](https://script.google.com/)
   - 開啟「任務交辦系統後端」專案

2. **開啟專案設定**
   - 點擊左側的「專案設定」圖示（⚙️ 齒輪圖示）
   - 或點擊右上角的「專案設定」按鈕

3. **新增指令碼屬性**
   - 向下滾動找到「指令碼屬性」區塊
   - 點擊「新增指令碼屬性」按鈕
   - **屬性名稱**：輸入 `GEMINI_API_KEY`
   - **值**：貼上你的 Gemini API Key
   - 點擊「儲存指令碼屬性」

4. **確認設定**
   - 應該會看到新建立的屬性：
     - 名稱：`GEMINI_API_KEY`
     - 值：（顯示為 `●●●●●●` 隱藏）

---

## ✅ 設定完成檢查

### 方法 1：執行測試函數

1. 在 Google Apps Script 編輯器中
2. 選擇 `testGeminiAPI` 函數
3. 點擊「執行」
4. 查看執行記錄

如果看到「✅ 成功從指令碼屬性讀取 Gemini API Key」，表示設定成功。

### 方法 2：檢查指令碼屬性

1. 點擊「專案設定」
2. 查看「指令碼屬性」區塊
3. 確認 `GEMINI_API_KEY` 存在

---

## 🔧 更新 API Key

如果需要更新 API Key：

1. 點擊「專案設定」
2. 找到 `GEMINI_API_KEY` 屬性
3. 點擊「編輯」（鉛筆圖示）
4. 更新「值」
5. 點擊「儲存指令碼屬性」

---

## 🔒 安全性說明

### 優點

✅ **更安全**：API Key 不會暴露在試算表中  
✅ **更隱私**：只有專案擁有者可以看到  
✅ **更方便**：不需要在試算表中管理  
✅ **更專業**：符合最佳實踐

### 注意事項

- 指令碼屬性只有專案擁有者可以查看和編輯
- 如果分享專案給其他人，他們無法看到指令碼屬性的值
- API Key 在執行記錄中不會顯示完整內容

---

## 🧪 測試 AI 功能

### 方法 1：透過前端測試

1. 啟動前端應用程式：`npm run dev`
2. 點擊「交辦任務」
3. 在「任務描述」欄位輸入文字
4. 點擊「串接 AI 形成結構化工作任務」按鈕
5. 等待 AI 分析完成
6. 查看生成的結構化任務說明

### 方法 2：透過 Google Apps Script 測試

1. 在編輯器中選擇 `testGeminiAPI` 函數
2. 點擊「執行」
3. 查看執行記錄

---

## 🐛 常見問題

### Q1: 找不到指令碼屬性選項

**解決方案**：
- 確認你已經開啟了專案設定頁面
- 向下滾動找到「指令碼屬性」區塊
- 如果沒有看到，確認你是專案擁有者

### Q2: 執行時顯示「找不到 Gemini API Key」

**檢查**：
1. 確認屬性名稱是 `GEMINI_API_KEY`（完全一致，大小寫敏感）
2. 確認 API Key 值正確（以 `AIza` 開頭）
3. 確認已點擊「儲存指令碼屬性」

### Q3: API Key 格式錯誤

**檢查**：
- API Key 應該以 `AIza` 開頭
- 長度約 39 個字元
- 不包含空格或換行

---

## 📝 指令碼屬性 vs 試算表

| 特性 | 指令碼屬性 | 試算表 |
|------|-----------|--------|
| 安全性 | ✅ 高（只有擁有者可見） | ⚠️ 中（試算表權限控制） |
| 方便性 | ✅ 高（集中管理） | ⚠️ 中（需要開啟試算表） |
| 隱私性 | ✅ 高 | ⚠️ 中 |
| 最佳實踐 | ✅ 推薦 | ⚠️ 可用但不推薦 |

---

## 🔗 相關連結

- [Google AI Studio](https://aistudio.google.com/app/apikey) - 取得 API Key
- [Gemini API 文件](https://ai.google.dev/docs) - API 使用說明
- [Google Apps Script 指令碼屬性文件](https://developers.google.com/apps-script/guides/properties) - 詳細說明

