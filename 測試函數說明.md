# Google Apps Script 測試函數說明

## ⚠️ 重要提醒

**`doPost` 和 `doGet` 函數不能直接在編輯器中執行！**

這些函數是 Google Apps Script 的 Web App 處理函數，需要透過 HTTP 請求來觸發。如果直接在編輯器中執行，會出現以下錯誤：

- `doPost`: ❌ 錯誤：缺少 POST 資料（因為沒有提供事件物件）
- `doGet`: ❌ doGet 錯誤：Cannot read properties of undefined (reading 'parameter')（因為 e 參數為 undefined）

## ✅ 正確的測試方式

### 方式 1：使用測試函數

在 `Code.gs` 中已經提供了測試函數，可以直接執行：

1. **測試建立任務**：
   - 在編輯器中選擇 `testSaveTask` 函數
   - 點擊「執行」
   - 查看執行記錄

2. **測試建立員工**：
   - 選擇 `testSaveUser` 函數
   - 點擊「執行」
   - 查看執行記錄

3. **測試取得任務列表**：
   - 選擇 `testGetTasks` 函數
   - 點擊「執行」
   - 查看執行記錄

4. **測試取得人員列表**：
   - 選擇 `testGetUsers` 函數
   - 點擊「執行」
   - 查看執行記錄

### 方式 2：透過 Web App URL 測試

1. **測試 GET 請求**：
   在瀏覽器中訪問：
   ```
   https://script.google.com/macros/s/YOUR_WEB_APP_ID/exec?action=getUsers
   ```
   
   應該會看到 JSON 回應：
   ```json
   {
     "success": true,
     "data": [...]
   }
   ```

2. **測試 POST 請求**：
   需要使用工具（如 Postman）或前端應用程式來發送 POST 請求。

### 方式 3：使用前端應用程式測試

1. 啟動前端應用程式：`npm run dev`
2. 在瀏覽器中操作界面
3. 查看瀏覽器 Console 和 Google Apps Script 執行記錄

## 🔍 查看執行記錄

1. 在 Google Apps Script 編輯器中
2. 點擊「檢視」→「執行記錄」
3. 查看詳細的日誌訊息

## 📝 測試函數列表

- `testSaveTask()` - 測試建立任務
- `testSaveUser()` - 測試建立員工
- `testGetTasks()` - 測試取得任務列表
- `testGetUsers()` - 測試取得人員列表
- `testGetDefault()` - 測試預設回應

## ⚠️ 常見錯誤

### 錯誤 1：直接在編輯器中執行 doPost 或 doGet

**錯誤訊息**：
- `❌ 錯誤：缺少 POST 資料`
- `❌ doGet 錯誤：Cannot read properties of undefined (reading 'parameter')`

**解決方案**：
- 不要直接執行 `doPost` 或 `doGet`
- 使用提供的測試函數（`testSaveTask`、`testGetUsers` 等）

### 錯誤 2：Web App 未部署

**錯誤訊息**：
- `404 Not Found`
- `無法連接到伺服器`

**解決方案**：
1. 確認 Web App 已部署
2. 確認 Web App URL 正確
3. 確認部署設定中選擇「任何人」可以存取

## 🎯 建議的測試流程

1. **先測試後端函數**：
   - 執行 `testSaveUser()` 確認員工資料可以儲存
   - 執行 `testGetUsers()` 確認可以讀取員工資料

2. **測試 Web App**：
   - 在瀏覽器中訪問 Web App URL
   - 確認可以看到預設回應

3. **測試前端整合**：
   - 啟動前端應用程式
   - 嘗試建立員工
   - 查看 Google Sheets 是否有新資料

## 📞 需要協助？

如果測試函數也出現錯誤，請檢查：
1. Google Sheets ID 是否正確
2. 工作表名稱是否正確
3. 是否有足夠的權限存取試算表

